<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jio M3U Player</title>
<style>
    body { font-family: Arial, sans-serif; background: #f0f0f0; padding: 20px; }
    input, button { padding: 10px; font-size: 16px; margin: 5px 0; }
    #channels { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px; }
    .channel { background: #fff; padding: 10px; border-radius: 8px; cursor: pointer; width: 200px; text-align: center; box-shadow: 0 2px 6px rgba(0,0,0,0.2);}
    .channel img { max-width: 100%; border-radius: 4px; }
</style>
</head>
<body>

<h1>Jio M3U Player</h1>
<input type="text" id="m3uUrl" placeholder="Paste M3U URL here" size="50"/>
<button onclick="loadM3U()">Load Channels</button>

<div id="channels"></div>

<script>
async function loadM3U() {
    const url = document.getElementById('m3uUrl').value;
    if (!url) return alert('Please enter an M3U URL.');

    try {
        const res = await fetch(url);
        const text = await res.text();

        const lines = text.split('\n');
        const channels = [];

        for (let i = 0; i < lines.length; i++) {
            const line = lines[i];
            if (line.startsWith('#EXTINF')) {
                const infoMatch = line.match(/tvg-logo="(.*?)".*?,(.*)/);
                if (!infoMatch) continue;

                const logo = infoMatch[1];
                const name = infoMatch[2];

                // Stream URL is usually next line that is not comment
                let streamUrl = '';
                for (let j = i + 1; j < lines.length; j++) {
                    if (!lines[j].startsWith('#') && lines[j].trim()) {
                        streamUrl = lines[j].trim();
                        break;
                    }
                }

                if (streamUrl) channels.push({name, logo, streamUrl});
            }
        }

        displayChannels(channels);
    } catch (err) {
        console.error(err);
        alert('Failed to fetch or parse M3U.');
    }
}

function displayChannels(channels) {
    const container = document.getElementById('channels');
    container.innerHTML = '';

    channels.forEach(ch => {
        const div = document.createElement('div');
        div.className = 'channel';
        div.innerHTML = `
            <img src="${ch.logo}" alt="${ch.name}">
            <p>${ch.name}</p>
        `;
        div.onclick = () => {
            const playerUrl = 'https://cinearena.github.io/jioplyr.html?url=' + encodeURIComponent(ch.streamUrl);
            window.open(playerUrl, '_blank');
        };
        container.appendChild(div);
    });
}
</script>

</body>
</html>
